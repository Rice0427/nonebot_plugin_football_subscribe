# NoneBot 足球比赛订阅插件

一个基于 NoneBot2 的足球比赛订阅插件，支持订阅足球比赛并在比赛结束后自动生成赛后总结。

## 功能特性

- 支持通过球队名称订阅即将进行的足球比赛
- 比赛结束后1分钟内自动生成并发送赛后总结
- 赛后总结包括比分、两队数据对比（控球率、射门次数、射正次数等）和比赛评价
- 支持查看当前群组订阅的所有比赛
- 支持取消已订阅的比赛

## 安装方法

将 `nonebot_plugin_football_subscribe` 文件夹复制到你的 NoneBot2 项目的 `src/plugins` 目录下即可。

此外，还需要安装以下依赖：

```bash
pip install httpx
```

## 配置步骤

1. **获取足球数据API密钥**
   - 访问 https://www.football-data.org/ 注册账号
   - 获取免费的API密钥

2. **配置NoneBot2**
   - 在你的NoneBot2配置文件中添加以下配置项：
     ```python
     # 足球比赛API配置
     football_api_url = "https://api.football-data.org/v4/"  # 默认值，通常不需要修改
     football_api_token = "你的API密钥"  # 必须配置
     
     # 订阅相关配置（可选）
     match_check_interval = 60  # 检查比赛状态的间隔时间（秒）
     summary_delay_minutes = 1  # 比赛结束后延迟生成总结的时间（分钟）
     
     # 存储配置（可选）
     use_database = False  # 是否使用数据库存储订阅信息
     database_url = "sqlite:///./football_subscribe.db"  # 数据库连接URL
     ```

## 使用示例

### 订阅比赛

在QQ群内发送以下命令：

```
订阅足球 [球队名称]
```

例如：

```
订阅足球 曼联
订阅足球 巴塞罗那
```

如果找到多个包含该球队的比赛，机器人会列出所有匹配的比赛，你可以输入序号选择要订阅的比赛。

### 取消订阅

在QQ群内发送以下命令：

```
取消足球订阅 [球队名称]
```

例如：

```
取消足球订阅 曼联
```

如果不指定球队名称，机器人会列出当前群组订阅的所有比赛，你可以输入序号选择要取消的订阅。

### 查看订阅列表

在QQ群内发送以下命令：

```
足球订阅列表
```

机器人会显示当前群组订阅的所有足球比赛及其订阅人数。

## 赛后总结示例

比赛结束后1分钟内，机器人会自动发送类似以下格式的赛后总结：

```
【曼联 VS 利物浦】赛后总结
比分：曼联 2 - 1 利物浦

两队数据对比：
控球率：48%（曼联） vs 52%（利物浦）
射门次数：12（曼联） vs 15（利物浦）
射正次数：5（曼联） vs 6（利物浦）
角球次数：4（曼联） vs 7（利物浦）
犯规次数：10（曼联） vs 12（利物浦）

比赛评价：曼联表现出色，成功击败利物浦，取得了宝贵的胜利！
```

## 注意事项

1. 插件使用的是 [football-data.org](https://www.football-data.org/) 提供的免费API，有访问次数限制
2. 免费API可能无法获取所有比赛的详细统计数据
3. 请确保正确配置API密钥，否则无法获取比赛数据
4. 插件会在比赛结束后1分钟内发送总结，如果比赛数据延迟更新，总结可能会相应延迟
5. 订阅信息保存在插件目录下的 `subscriptions.json` 文件中

## 常见问题

### 为什么找不到我想订阅的球队？
- 请尝试使用球队的英文名称或缩写
- 确保该球队近期有即将进行的比赛
- 检查API密钥是否正确配置

### 为什么赛后没有收到总结？
- 可能是API无法获取该比赛的详细数据
- 可能是比赛时间发生了变化
- 检查机器人是否正常运行

### API请求限制是多少？
- 免费账号通常有每分钟10次、每小时100次的访问限制
- 如果超过限制，插件可能暂时无法获取数据

## 更新日志

### v0.1.0
- 初始版本
- 支持通过球队名称订阅足球比赛
- 自动生成赛后总结
- 支持查看和取消订阅